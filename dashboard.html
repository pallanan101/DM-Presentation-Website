<div class="space-y-6">
    <div class="flex justify-between items-center mb-6">
        <h1 class="text-3xl font-bold text-gray-900 logo-text">Management Dashboard</h1>
        
        <div class="relative">
            <button id="date-filter-button" class="bg-gray-200 p-2 rounded-lg flex items-center space-x-2 text-sm font-medium hover:bg-gray-400 text-gray-900">
                <i class="fas fa-calendar-alt"></i>
                <span id="date-range-display">Last 7 Days</span>
                <i class="fas fa-chevron-down text-xs"></i>
            </button>
            <div id="date-filter-dropdown" class="absolute rounded-xl right-0 mt-2 w-64 bg-gray-200 shadow-xl z-20 hidden p-4 space-y-3">
                <h4 class="font-bold text-base mb-2 border-b border-gray-200 text-gray-900 pb-2">Select Date Range</h4>
                <div class="space-y-2">
                    <label for="start-date" class="block text-sm font-medium text-gray-600">Start Date</label>
                    <input type="date" id="start-date" value="2025-09-19" class="w-full p-2 rounded-lg bg-gray-100  border border-gray-300 text-gray-900 focus:outline-none focus:ring-2 focus:ring-blue-500">
                </div>
                <div class="space-y-2">
                    <label for="end-date" class="block text-sm font-medium text-gray-600">End Date</label>
                    <input type="date" id="end-date" value="2025-09-26" class="w-full p-2 rounded-lg bg-gray-100  border border-gray-300 text-gray-900 focus:outline-none focus:ring-2 focus:ring-blue-500">
                </div>
                <button id="apply-filter-button" class="w-full bg-blue-600 hover:bg-blue-700 text-white font-semibold py-2 rounded-lg transition duration-300">
                    Apply Filter
                </button>
            </div>
        </div>
    </div>

    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6">
        <div class="bg-gray-200 p-6 flex flex-col items-start space-y-2 rounded-xl shadow-lg">
            <div class="flex items-center space-x-3">
                <i class="fas fa-clock text-2xl text-orange-400"></i>
                <h3 class="text-lg font-semibold text-gray-900">Pending Moderation</h3>
            </div>
            <p class="text-3xl font-bold text-gray-900">52</p>
            <p class="text-gray-500 text-sm">No change</p>
        </div>
        <div class="bg-gray-200 p-6 flex flex-col items-start space-y-2 rounded-xl shadow-lg">
            <div class="flex items-center space-x-3">
                <i class="fas fa-check-circle text-2xl text-green-400"></i>
                <h3 class="text-lg font-semibold text-gray-900">Total Moderated</h3>
            </div>
            <p class="text-3xl font-bold text-gray-900">12,895</p>
            <p class="text-green-500 text-sm flex items-center space-x-1">
                <i class="fas fa-arrow-up"></i>
                <span>5% since last week</span>
            </p>
        </div>
        <div class="bg-gray-200 p-6 flex flex-col items-start space-y-2 rounded-xl shadow-lg">
            <div class="flex items-center space-x-3">
                <i class="fas fa-bullseye text-2xl text-blue-400"></i>
                <h3 class="text-lg font-semibold text-gray-900">Moderation Accuracy</h3>
            </div>
            <p class="text-3xl font-bold text-gray-900">98.7%</p>
            <p class="text-red-500 text-sm flex items-center space-x-1">
                <i class="fas fa-arrow-down"></i>
                <span>0.1% since last week</span>
            </p>
        </div>
        <div class="bg-gray-200 p-6 flex flex-col items-start space-y-2 rounded-xl shadow-lg">
            <div class="flex items-center space-x-3">
                <i class="fas fa-stopwatch text-2xl text-purple-400"></i>
                <h3 class="text-lg font-semibold text-gray-900">Average Handling Time</h3>
            </div>
            <p class="text-3xl font-bold text-gray-900">45s</p>
            <p class="text-green-500 text-sm flex items-center space-x-1">
                <i class="fas fa-arrow-down"></i>
                <span>2s improvement</span>
            </p>
        </div>
    </div>

    <div class="grid grid-cols-1 lg:grid-cols-3 gap-6 mt-6">
        <div class="lg:col-span-2 bg-gray-200 p-6 rounded-xl shadow-lg">
            <h3 class="text-xl font-bold mb-4 text-gray-900">Content Trends</h3>
            <div style="height: 300px;">
                <canvas id="trends-chart"></canvas>
            </div>
        </div>
        <div class="bg-gray-200 p-6 flex flex-col space-y-4 rounded-xl shadow-lg">
            <h3 class="text-xl font-bold mb-2 text-gray-900">Links</h3>
            <div class="space-y-3">
                <div class="p-3 bg-gray-200 cursor-pointer flex items-center space-x-3 border border-gray-200 rounded-lg hover:bg-gray-400 transition duration-150">
                    <i class="fas fa-file-alt text-blue-500 w-5 h-5"></i>
                    <span class="font-medium text-gray-900">Playbook Rules</span>
                </div>
                <div class="p-3 bg-gray-200 cursor-pointer flex items-center space-x-3 border border-gray-200 rounded-lg hover:bg-gray-400 transition duration-150">
                    <i class="fas fa-bullhorn text-orange-500 w-5 h-5"></i>
                    <span class="font-medium text-gray-900">New Policy and Updates</span>
                </div>
                <div class="p-3 bg-gray-200 cursor-pointer flex items-center space-x-3 border border-gray-200 rounded-lg hover:bg-gray-400 transition duration-150">
                    <i class="fas fa-lightbulb text-yellow-500 w-5 h-5"></i>
                    <span class="font-medium text-gray-900">Suggestions</span>
                </div>
                <div class="p-3 bg-gray-200 cursor-pointer flex items-center space-x-3 border border-gray-200 rounded-lg hover:bg-gray-400 transition duration-150">
                    <i class="fas fa-question-circle text-green-500 w-5 h-5"></i>
                    <span class="font-medium text-gray-900">Help</span>
                </div>
            </div>
        </div>
    </div>
</div>


<script>
    // --- DOM element retrieval is safe here since the script is executed after the elements are defined in the HTML
    const dateFilterButton = document.getElementById('date-filter-button');
    const dateFilterDropdown = document.getElementById('date-filter-dropdown');
    const applyFilterButton = document.getElementById('apply-filter-button');
    const startDateInput = document.getElementById('start-date');
    const endDateInput = document.getElementById('end-date');
    const dateRangeDisplay = document.getElementById('date-range-display');

    // --- Utility Function to swap classes on loaded content ---
    function updateContentTheme() {
        const isDark = localStorage.getItem('theme') === 'dark';
        const isLight = !isDark;
        
        // Target: All cards/containers (bg-white <-> bg-gray-900)
        // Note: The HTML fragment uses bg-white/bg-gray-900 as placehodlers which are set by the router logic in index.html
        
        const mainElements = document.querySelectorAll(
            '.bg-white.bg-gray-900, .bg-gray-600' // Target card backgrounds and date inputs
        );

        mainElements.forEach(el => {
            // Apply background color swap (bg-white <-> bg-gray-900 or similar dark card color)
            if (isLight) {
                el.classList.remove('bg-gray-900', 'bg-gray-600');
                el.classList.add('bg-white');
            } else {
                // Determine which dark class to apply (bg-gray-900 for cards, bg-gray-600 for inputs)
                if (el.id === 'start-date' || el.id === 'end-date' || el.id === 'date-filter-dropdown' || el.id === 'date-filter-button') {
                     el.classList.remove('bg-white', 'bg-gray-100');
                     el.classList.add('bg-gray-600');
                } else {
                    el.classList.remove('bg-white');
                    el.classList.add('bg-gray-900');
                }
            }
            
            // Apply text color swap (text-gray-900 <-> text-gray-50/200)
            if (isLight) {
                el.classList.remove('text-gray-50', 'text-gray-200');
                el.classList.add('text-gray-900');
            } else {
                 el.classList.remove('text-gray-900');
                 el.classList.add('text-gray-50');
            }
        });

        // Specific adjustments for text elements inside cards that might not inherit
        document.querySelectorAll('h3, p, span').forEach(el => {
            if (el.closest('.bg-white, .bg-gray-900') && !el.classList.contains('text-green-500') && !el.classList.contains('text-red-500') && !el.classList.contains('text-orange-400') && !el.classList.contains('text-blue-400') && !el.classList.contains('text-purple-400')) {
                if (isLight) {
                    el.classList.remove('text-gray-200');
                    el.classList.add('text-gray-900');
                } else {
                    el.classList.remove('text-gray-900');
                    el.classList.add('text-gray-200');
                }
            }
        });
        
    }
    
    // --- Date Filter Dropdown Logic ---
    if (dateFilterButton) {
        dateFilterButton.addEventListener('click', (e) => {
            e.stopPropagation();
            dateFilterDropdown.classList.toggle('hidden');
        });
    }

    // Close dropdown on click outside
    document.addEventListener('click', (e) => {
        if (dateFilterDropdown && !dateFilterDropdown.contains(e.target) && !dateFilterButton.contains(e.target)) {
            dateFilterDropdown.classList.add('hidden');
        }
    });

    // --- Date Utility Functions ---

    function formatDate(date) {
        return date.toISOString().split('T')[0];
    }

    function updateDateInputs(start, end) {
        if (startDateInput && endDateInput && dateRangeDisplay) {
            startDateInput.value = formatDate(start);
            endDateInput.value = formatDate(end);
            dateRangeDisplay.textContent = `${formatDate(start)} to ${formatDate(end)}`;
        }
    }

    // Set initial date range (Last 7 Days)
    function initializeDateRange() {
        const today = new Date();
        const lastWeek = new Date();
        lastWeek.setDate(today.getDate() - 7);
        updateDateInputs(lastWeek, today);
    }
    initializeDateRange();

    // --- Chart.js Content Trends Chart ---
    let trendsChart;

    function renderTrendsChart() {
        const ctx = document.getElementById('trends-chart').getContext('2d');
        const labels = ['Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat', 'Sun'];
        const data = {
            labels: labels,
            datasets: [
                {
                    label: 'Moderated Content',
                    data: [350, 410, 390, 450, 420, 500, 480],
                    borderColor: 'rgba(59, 130, 246, 1)', // Blue-500
                    backgroundColor: 'rgba(59, 130, 246, 0.2)',
                    tension: 0.3,
                    fill: true
                },
                {
                    label: 'Incoming Volume',
                    data: [360, 400, 420, 440, 430, 510, 490],
                    borderColor: 'rgba(16, 185, 129, 1)', // Green-500
                    backgroundColor: 'rgba(16, 185, 129, 0.2)',
                    tension: 0.3,
                    fill: true
                }
            ]
        };

        // Determine theme color for chart elements
        const themeColor = localStorage.getItem('theme') === 'dark' ? 'rgba(255, 255, 255, 0.8)' : 'rgba(0, 0, 0, 0.8)';
        const gridColor = localStorage.getItem('theme') === 'dark' ? 'rgba(255, 255, 255, 0.1)' : 'rgba(0, 0, 0, 0.1)';

        const config = {
            type: 'line',
            data: data,
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: {
                    legend: {
                        labels: {
                            color: themeColor,
                        }
                    },
                    title: {
                        display: false
                    }
                },
                scales: {
                    y: {
                        beginAtZero: true,
                        grid: {
                            color: gridColor,
                            borderColor: themeColor
                        },
                        ticks: {
                            color: themeColor
                        }
                    },
                    x: {
                        grid: {
                            color: gridColor,
                            borderColor: themeColor
                        },
                        ticks: {
                            color: themeColor
                        }
                    }
                }
            }
        };

        if (trendsChart) {
            trendsChart.destroy();
        }
        trendsChart = new Chart(ctx, config);
    }

    // Function to run when filter is applied or view is loaded
    function updateDashboardData() {
        // Apply the stored theme colors to the loaded HTML content
        updateContentTheme(); 
        
        // Re-render chart to pick up potential theme changes or new data
        renderTrendsChart();

        // Close dropdown
        if (dateFilterDropdown) {
             dateFilterDropdown.classList.add('hidden');
        }
    }

    // Event Listeners
    if (applyFilterButton) {
        applyFilterButton.addEventListener('click', updateDashboardData);
    }

    // Global listener to re-render chart on theme change
    // This assumes the theme toggle in index.html updates the localStorage item 'theme'
    const observer = new MutationObserver(function(mutations) {
        mutations.forEach(function(mutation) {
            if (mutation.attributeName === 'class' && mutation.target === document.body) {
                // Body class changed, run theme updates on the content
                updateDashboardData();
            }
        });
    });
    observer.observe(document.body, { attributes: true });


    // Initialize the chart and theme on load
    updateDashboardData();
</script>